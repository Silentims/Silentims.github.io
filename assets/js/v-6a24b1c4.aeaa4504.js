"use strict";(self.webpackChunkswbook=self.webpackChunkswbook||[]).push([[551],{8972:(n,s,a)=>{a.r(s),a.d(s,{data:()=>e});const e={key:"v-6a24b1c4",path:"/about/about-docs-server-build.html",title:"关于 - 文档的自动化部署",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"持续集成和部署",slug:"持续集成和部署",children:[{level:3,title:"创建脚本",slug:"创建脚本",children:[]},{level:3,title:"配置脚本",slug:"配置脚本",children:[]},{level:3,title:"执行脚本",slug:"执行脚本",children:[]},{level:3,title:"访问 Github Pages",slug:"访问-github-pages",children:[]}]},{level:2,title:"域名访问",slug:"域名访问",children:[{level:3,title:"域名注册",slug:"域名注册",children:[]},{level:3,title:"域名解析",slug:"域名解析",children:[]}]},{level:2,title:"SSL 证书申请",slug:"ssl-证书申请",children:[]},{level:2,title:"Nginx安装与配置",slug:"nginx安装与配置",children:[{level:3,title:"安装",slug:"安装",children:[]},{level:3,title:"配置",slug:"配置",children:[]}]}],filePathRelative:"about/about-docs-server-build.md",git:{updatedTime:1628869253e3}}},8445:(n,s,a)=>{a.r(s),a.d(s,{default:()=>Xn});var e=a(6252),l=a(7688),t=a(1940),c=a(7933),_=a(6818),r=a(8914),i=a(1643);const o=(0,e._)("h1",{id:"关于-文档的自动化部署",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#关于-文档的自动化部署","aria-hidden":"true"},"#"),(0,e.Uk)(" 关于 - 文档的自动化部署")],-1),u=(0,e._)("h2",{id:"持续集成和部署",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#持续集成和部署","aria-hidden":"true"},"#"),(0,e.Uk)(" 持续集成和部署")],-1),p=(0,e._)("h3",{id:"创建脚本",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#创建脚本","aria-hidden":"true"},"#"),(0,e.Uk)(" 创建脚本")],-1),b=(0,e._)("p",null,[(0,e.Uk)("在本地"),(0,e._)("code",null,"swbook"),(0,e.Uk)("目录下，创建新文件目录"),(0,e._)("code",null,".github/workflow"),(0,e.Uk)(",并创建"),(0,e._)("code",null,"main.yml"),(0,e.Uk)("文件")],-1),k=(0,e._)("div",{class:"language-bash ext-sh line-numbers-mode"},[(0,e._)("pre",{class:"language-bash"},[(0,e._)("code",null,[(0,e._)("span",{class:"token builtin class-name"},"cd"),(0,e.Uk)(" swbook\n"),(0,e._)("span",{class:"token function"},"mkdir"),(0,e.Uk)(" -p .github/workflow\n"),(0,e._)("span",{class:"token builtin class-name"},"cd"),(0,e.Uk)(" .github/workflow\n"),(0,e._)("span",{class:"token function"},"touch"),(0,e.Uk)(" main.yml\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br")])],-1),m=(0,e._)("h3",{id:"配置脚本",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#配置脚本","aria-hidden":"true"},"#"),(0,e.Uk)(" 配置脚本")],-1),d=(0,e._)("p",null,[(0,e.Uk)("修改"),(0,e._)("code",null,"main.yml"),(0,e.Uk)("文件：")],-1),h=(0,e._)("div",{class:"language-yaml ext-yml line-numbers-mode"},[(0,e._)("pre",{class:"language-yaml"},[(0,e._)("code",null,[(0,e._)("span",{class:"token key atrule"},"name"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" Deploy GitHub Pages\n\n"),(0,e._)("span",{class:"token comment"},"# 触发条件：在 push 到 master 分支后"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token key atrule"},"on"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token key atrule"},"push"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token key atrule"},"branches"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token punctuation"},"-"),(0,e.Uk)(" master\t"),(0,e._)("span",{class:"token comment"},"#注意要和 Github仓库的分支名一致，有些人 Github 仓库默认是 main"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token comment"},"# 任务"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token key atrule"},"jobs"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token key atrule"},"build-and-deploy"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"# 服务器环境：最新版 Ubuntu"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token key atrule"},"runs-on"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" ubuntu"),(0,e._)("span",{class:"token punctuation"},"-"),(0,e.Uk)("latest\n    "),(0,e._)("span",{class:"token key atrule"},"steps"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token comment"},"# 拉取代码"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token punctuation"},"-"),(0,e.Uk)(),(0,e._)("span",{class:"token key atrule"},"name"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" Checkout\n        "),(0,e._)("span",{class:"token key atrule"},"uses"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" actions/checkout@v2\n        "),(0,e._)("span",{class:"token key atrule"},"with"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)("\n          "),(0,e._)("span",{class:"token key atrule"},"persist-credentials"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean important"},"false"),(0,e.Uk)("\n\n      "),(0,e._)("span",{class:"token comment"},"# 1、生成静态文件"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token punctuation"},"-"),(0,e.Uk)(),(0,e._)("span",{class:"token key atrule"},"name"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" Build\n        "),(0,e._)("span",{class:"token key atrule"},"run"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" npm install "),(0,e._)("span",{class:"token important"},"&&"),(0,e.Uk)(" npm run docs"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)("build\n\n      "),(0,e._)("span",{class:"token comment"},"# 2、部署到 GitHub Pages"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token punctuation"},"-"),(0,e.Uk)(),(0,e._)("span",{class:"token key atrule"},"name"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" Deploy\n        "),(0,e._)("span",{class:"token key atrule"},"uses"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" JamesIves/github"),(0,e._)("span",{class:"token punctuation"},"-"),(0,e.Uk)("pages"),(0,e._)("span",{class:"token punctuation"},"-"),(0,e.Uk)("deploy"),(0,e._)("span",{class:"token punctuation"},"-"),(0,e.Uk)("action@releases/v3\n        "),(0,e._)("span",{class:"token key atrule"},"with"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)("\n          "),(0,e._)("span",{class:"token key atrule"},"ACCESS_TOKEN"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" $"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(" secrets.ACCESS_TOKEN "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\t"),(0,e._)("span",{class:"token comment"},"# Github 的 token"),(0,e.Uk)("\n          "),(0,e._)("span",{class:"token key atrule"},"REPOSITORY_NAME"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" silentims/silentims.github.io\t"),(0,e._)("span",{class:"token comment"},"# Github Pages 对应的仓库地址"),(0,e.Uk)("\n          "),(0,e._)("span",{class:"token key atrule"},"BRANCH"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" master\t"),(0,e._)("span",{class:"token comment"},"# Github Pages 对应的仓库的分支"),(0,e.Uk)("\n          "),(0,e._)("span",{class:"token key atrule"},"FOLDER"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" docs/.vuepress/dist\t"),(0,e._)("span",{class:"token comment"},"#注意这里的 docs/.vuepress/dist 表示的是 npm run docs:build 打包生成静态资源的路径，因为我们的目的是只需要将打包后的全部文件推送到 Github Pages 仓库即可，实在不清楚这个目录配置的对不对，可以先在本地执行 npm run docs:build，看看编译后的文件 dist 存在哪里，如果按照我上述的文件结构，不需要修改"),(0,e.Uk)("\n          \n      "),(0,e._)("span",{class:"token comment"},"# 3、部署到云服务器（不涉及可以注释或删除）"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token punctuation"},"-"),(0,e.Uk)(),(0,e._)("span",{class:"token key atrule"},"name"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" rsync deployments\n      \t"),(0,e._)("span",{class:"token comment"},"# 关于该插件详细可阅读https://github.com/Burnett01/rsync-deployments"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token key atrule"},"uses"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" burnett01/rsync"),(0,e._)("span",{class:"token punctuation"},"-"),(0,e.Uk)("deployments@5.0 \n        "),(0,e._)("span",{class:"token key atrule"},"with"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)("\n          "),(0,e._)("span",{class:"token comment"},'# 这里是 rsync 的参数 switches: -avzh --delete --exclude="" --include="" --filter=""'),(0,e.Uk)("\n          "),(0,e._)("span",{class:"token key atrule"},"switches"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"-"),(0,e.Uk)("avzh\n          "),(0,e._)("span",{class:"token key atrule"},"path"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" docs/.vuepress/dist/\t"),(0,e._)("span",{class:"token comment"},"# github 源目录"),(0,e.Uk)("\n          "),(0,e._)("span",{class:"token key atrule"},"remote_path"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" /root/nginx/www/\t"),(0,e._)("span",{class:"token comment"},"# 云服务器目标目录"),(0,e.Uk)("\n          "),(0,e._)("span",{class:"token key atrule"},"remote_host"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" techxiang.com\t"),(0,e._)("span",{class:"token comment"},"# 这里可以是域名（域名已解析到云服务器）或者直接是云服务器公网ip"),(0,e.Uk)("\n          "),(0,e._)("span",{class:"token key atrule"},"remote_user"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" root\t"),(0,e._)("span",{class:"token comment"},"# 云服务器的用户"),(0,e.Uk)("\n          "),(0,e._)("span",{class:"token key atrule"},"remote_key"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" $"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(" secrets.ALIYUN_RSA_PRIVATE_KEY "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\t"),(0,e._)("span",{class:"token comment"},"# 云服务器私钥"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"21"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"22"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"23"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"24"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"25"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"26"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"27"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"28"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"29"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"30"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"31"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"32"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"33"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"34"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"35"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"36"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"37"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"38"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"39"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"40"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"41"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"42"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"43"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"44"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"45"),(0,e._)("br")])],-1),U=(0,e._)("p",null,[(0,e._)("strong",null,"文件中的部分参数说明")],-1),g=(0,e._)("ul",null,[(0,e._)("li",null,[(0,e._)("code",null,"on"),(0,e.Uk)(" 表示触发条件")]),(0,e._)("li",null,[(0,e._)("code",null,"jobs"),(0,e.Uk)(" 表示要做的工作")]),(0,e._)("li",null,[(0,e._)("code",null,"step"),(0,e.Uk)(" 表示要做的步骤，前一步失败，后面不会继续执行。")]),(0,e._)("li",null,[(0,e._)("code",null,"name"),(0,e.Uk)(" 表示 action 的名称，可以自定义")]),(0,e._)("li",null,[(0,e._)("code",null,"uses"),(0,e.Uk)(" 表示使用哪个插件，社区有很多优秀插件，可以直接搜索和使用")]),(0,e._)("li",null,[(0,e._)("code",null,"with"),(0,e.Uk)(" 表示传给插件的参数，一般在插件的主页都会有参数的使用说明")])],-1),x=(0,e._)("p",null,[(0,e._)("strong",null,"文件中参数涉及其他操作的说明")],-1),f=(0,e._)("ul",null,[(0,e._)("li",null,[(0,e._)("code",null,"REPOSITORY_NAME"),(0,e.Uk)("：silentims/silentims.github.io")])],-1),v=(0,e._)("p",null,"配置此项时，需要先去 Github 创建一个新库，Github Pages创建会依赖此库：",-1),y=(0,e._)("blockquote",null,[(0,e._)("p",null,"必须为 public 项目，同时勾选创建 README 文件，目的是创建后不再是一个空库，自动化脚本推送时避免空库而报错")],-1),S=(0,e._)("p",null,[(0,e._)("img",{src:l,alt:"image-20210810153121361"})],-1),w=(0,e._)("ul",null,[(0,e._)("li",null,[(0,e._)("code",null,"ACCESS_TOKEN"),(0,e.Uk)(":")])],-1),P=(0,e._)("p",null,"此处涉及两处特殊的参数值：ACCESS_TOKEN 和 ALIYUN_RSA_PRIVATE_KEY，分别参考以下说明：",-1),T=(0,e._)("details",{class:"custom-container details"},[(0,e._)("summary",null,"为什么要使用密钥？"),(0,e._)("p",null,"为了安全，像令牌，TOKEN 、云服务器 ip 地址等这类重要信息，不能够暴露给其他人，或者你认为很重要的其他信息，不想别人看到，那么就使用 Github 提供的 secrets 功能，避免泄露")],-1),E=(0,e._)("p",null,[(0,e._)("strong",null,"1. secrets.ACCESS_TOKEN")],-1),A=(0,e._)("p",null,"这个 ACCESS_TOKEN 是访问 GitHub API 的令牌，可以在 GitHub 主页，点击个人头像，Settings -> Developer settings -> Personal access tokens 进行生成或更新（权限选择 repo 相关的即可，如下图中橙色部分），第一次生成后你可以看到这个令牌，然后再也不会显示，因此你需要记下来，本篇假设生成的 TOKEN 令牌是 xxx",-1),G=(0,e._)("p",null,[(0,e.Uk)("然后打开项目"),(0,e._)("code",null,"swbook"),(0,e.Uk)("的Setting -> Secrets -> New repository secret：")],-1),N=(0,e._)("p",null,[(0,e._)("img",{src:t,alt:"image-20210810153312267"})],-1),C=(0,e._)("p",null,"加入环境变量， name 是 ACCESS_TOKEN，value 是 xxx。保存。",-1),I=(0,e._)("p",null,[(0,e._)("img",{src:c,alt:"image-20210810153347647"})],-1),H=(0,e._)("p",null,[(0,e._)("strong",null,"2.secrets.ALIYUN_RSA_PRIVATE_KEY")],-1),L=(0,e._)("blockquote",null,[(0,e._)("p",null,"不涉及云服务器发布可以跳过不配置")],-1),O=(0,e._)("p",null,"文件中这一项配置的是云服务器的私钥，一般情况下云服务器控制台都会提供一个私钥文件，如果服务器没有给你这个私钥，请自行登录云服务器生成一个可用于登录的私钥。",-1),R=(0,e._)("details",{class:"custom-container details"},[(0,e._)("summary",null,"为什么配置文件是私钥而不是公钥？"),(0,e._)("p",null,[(0,e.Uk)("因为 Github 自动化脚本运行时，属于创建连接的一段，会携带配置好的私钥访问云服务器，云服务器会拿到私钥解密，然后校验与"),(0,e._)("code",null,"authorized_keys"),(0,e.Uk)("中的公钥是否匹配，所以此处不要配置反了")])],-1),K=(0,e._)("p",null,"以下是生成公钥、私钥的操作步骤：",-1),D=(0,e._)("ol",null,[(0,e._)("li",null,"登录云服务器，查询或创建公钥、私钥：")],-1),Y=(0,e._)("div",{class:"language-bash ext-sh line-numbers-mode"},[(0,e._)("pre",{class:"language-bash"},[(0,e._)("code",null,[(0,e._)("span",{class:"token comment"},"# 查询目录下是否有 id_rsa 和 id_rsa.pub 前者是私钥，后者是公钥"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token builtin class-name"},"cd"),(0,e.Uk)(" ~/.ssh\n"),(0,e._)("span",{class:"token comment"},"# 若没有，则执行以下命令生成，这里生成 4096 位 RSA 密钥"),(0,e.Uk)("\nssh-keygen -t rsa -b "),(0,e._)("span",{class:"token number"},"4096"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br")])],-1),$=(0,e._)("ol",{start:"2"},[(0,e._)("li",null,[(0,e._)("p",null,[(0,e.Uk)("将"),(0,e._)("code",null,"id_rsa.pub"),(0,e.Uk)("公钥内容复制到同目录下的"),(0,e._)("code",null,"authorized_keys"),(0,e.Uk)("文件中")])]),(0,e._)("li",null,[(0,e._)("p",null,[(0,e.Uk)("将"),(0,e._)("code",null,"id_rsa"),(0,e.Uk)(" 私钥中的内容复制出来，然后到 GitHub 项目中添加为 Secrets（与 1 中配置 secrets.ACCESS_TOKEN 一样） 如下：")])])],-1),M=(0,e._)("p",null,[(0,e._)("img",{src:_,alt:"image-20210810153802480"})],-1),q=(0,e._)("h3",{id:"执行脚本",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#执行脚本","aria-hidden":"true"},"#"),(0,e.Uk)(" 执行脚本")],-1),z=(0,e._)("p",null,"完成 yml 文件配置后，可以将此配置文件从本地提交并推送到 Github 中，此时进入项目所在仓库->Actions 即可查看执行情况，如果打钩则发布成功，报错的点进去查看具体错误信息，根据错误信息来不断修改配置文件参数即可",-1),F=(0,e._)("p",null,[(0,e._)("img",{src:r,alt:"image-20210810153845431"})],-1),B=(0,e._)("h3",{id:"访问-github-pages",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#访问-github-pages","aria-hidden":"true"},"#"),(0,e.Uk)(" 访问 Github Pages")],-1),V=(0,e._)("p",null,"打开刚刚自动化部署到 Github Pages 的仓库，此时仓库中已经有了刚刚推送的静态网站文件，输入 https://silentims.github.io 即可访问(其中域名为创建的仓库名)",-1),W=(0,e._)("div",{class:"custom-container tip"},[(0,e._)("p",{class:"custom-container-title"},"恭喜 ~ 🎉 🎉 🎉"),(0,e._)("p",null,"至此，自动化部署已完成 Github Pages 的部分，如果有自己的域名，GIthub Pages 也支持修改为域名访问。")],-1),j=(0,e._)("div",{class:"custom-container warning"},[(0,e._)("p",{class:"custom-container-title"},"多说几句"),(0,e._)("p",null,"如果觉得 Github Pages 访问速度不理想，可以将 Github 仓库替换为国内的 Gitee，此处不做拓展，原理是基本一样的，以上也是目前大部分采用的免费搭建博客的方案，毕竟云服务器也需要花钱购买，所以单纯需要一个静态博客，完全不需要购买云服务器，毕竟云服务器除了新用户优惠力度大，后续每年续费的成本还是不小的一笔开支。")],-1),J=(0,e._)("h2",{id:"域名访问",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#域名访问","aria-hidden":"true"},"#"),(0,e.Uk)(" 域名访问")],-1),Q=(0,e._)("div",{class:"custom-container tip"},[(0,e._)("p",{class:"custom-container-title"},"提示"),(0,e._)("p",null,"前面已经将代码托管至 Github，同时通过 Action 脚本自动化部署发布到 Github Pages 和云服务器，Github Pages 可以直接访问到，但是推送到云服务器的静态网页文件却不能直接访问，所以本章目的就解决这个问题")],-1),X=(0,e._)("details",{class:"custom-container details"},[(0,e._)("summary",null,"💡 输入网址后是如何访问到服务器上的静态文件的？"),(0,e._)("p",null,"比如，输入我的主站网址 techxiang.com，大致流程就是，电脑的浏览器解析你输入的网址，然后通过你使用的操作系统调用网卡，网卡会将访问的目标地址、访问者 ip、物理网关等信息，通过你所在的网络环境，比如从路由器到光猫，然后到宽带运营商，运营商再根据你输入的网址，层层向下解析，最后找到百度服务器的 ip 地址，因为 ip 地址与具体某一台服务器做了备案绑定，这样就能访问到服务器上的内容，随后再以原同样的方式将内容响应到你的电脑上，通过浏览器渲染页面，就完成了。")],-1),Z=(0,e._)("p",null,"结合上面大致的流程，目前服务器上已经通过自动化部署后，有了静态资源文件，剩下只需要：",-1),nn=(0,e._)("ul",null,[(0,e._)("li",null,"注册一个域名，并将其解析到云服务器的 IP 上"),(0,e._)("li",null,"云服务器安装 Nginx 来代理该域名发到服务器的访问请求并返回服务器上静态页面资源"),(0,e._)("li",null,"提升用户访问安全性，还可以申请 HTTPS 证书，让网站支持 HTTPS 访问")],-1),sn={id:"域名注册",tabindex:"-1"},an=(0,e._)("a",{class:"header-anchor",href:"#域名注册","aria-hidden":"true"},"#",-1),en=(0,e.Uk)(" 域名注册 "),ln=(0,e.Uk)("可通过在阿里云的"),tn={href:"https://wanwang.aliyun.com/domain",target:"_blank",rel:"noopener noreferrer"},cn=(0,e.Uk)("域名注册"),_n=(0,e.Uk)("上查询和注册一个域名，需要实名认证，同时注册成功后，建议进行备案，不然可能容易出现无法访问的情况。"),rn=(0,e._)("h3",{id:"域名解析",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#域名解析","aria-hidden":"true"},"#"),(0,e.Uk)(" 域名解析")],-1),on=(0,e._)("p",null,"登录阿里云控制台，进入产品服务 -> 域名，可以管理已注册生效的域名，我们需要将域名解析到云服务器的公网 ip 上",-1),un=(0,e._)("blockquote",null,[(0,e._)("p",null,"由于注册的域名，一般都是顶级域名，比如 techxiang.com，为了大众对网站普遍的认知度，我们新增两条解析记录，除了解析到 techxiang.com之外，另一条解析到 www.techxiang.com，即都支持访问")],-1),pn=(0,e._)("ul",null,[(0,e._)("li",null,"记录类型：A"),(0,e._)("li",null,"主机记录：@ 和 www"),(0,e._)("li",null,"记录值：xx.xx.xx.xx (这是服务器的公网 ip)")],-1),bn=(0,e._)("p",null,"两条都新增后，如下图所示表示已经配置好，等待 10 分钟后生效",-1),kn=(0,e._)("p",null,[(0,e._)("img",{src:i,alt:"image-20210810153945933"})],-1),mn={id:"ssl-证书申请",tabindex:"-1"},dn=(0,e._)("a",{class:"header-anchor",href:"#ssl-证书申请","aria-hidden":"true"},"#",-1),hn=(0,e.Uk)(" SSL 证书申请"),Un=(0,e._)("details",{class:"custom-container details"},[(0,e._)("summary",null,"SSL 证书的好处"),(0,e._)("p",null,"(1)保障用户隐私信息安全"),(0,e._)("p",null,"(2)帮助用户识别钓鱼网站"),(0,e._)("p",null,"(3)利于网站SEO优化"),(0,e._)("p",null,"(4)提升公司品牌形象和可信度")],-1),gn=(0,e._)("p",null,"HTTPS 证书根据安全性不同收费也不同，最基础的免费 SSL 证书，可以在阿里云控制台搜索”SSL 证书“申请，当然也可以去第三方有资质的平台免费申请，一般免费的有效期是三个月到一年左右。",-1),xn=(0,e._)("h2",{id:"nginx安装与配置",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#nginx安装与配置","aria-hidden":"true"},"#"),(0,e.Uk)(" Nginx安装与配置")],-1),fn=(0,e._)("div",{class:"custom-container tip"},[(0,e._)("p",{class:"custom-container-title"},"提示"),(0,e._)("p",null,"网络上有很多安装的方法，此处不用原生下载后编译的方法，而使用 Docker 安装，并用挂载磁盘的方式管理和配置，简单方便")],-1),vn=(0,e._)("blockquote",null,[(0,e._)("p",null,"docker 的安装此处暂不做详细描述，后续可能会补充进来")],-1),yn=(0,e._)("h3",{id:"安装",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#安装","aria-hidden":"true"},"#"),(0,e.Uk)(" 安装")],-1),Sn=(0,e._)("div",{class:"language-bash ext-sh line-numbers-mode"},[(0,e._)("pre",{class:"language-bash"},[(0,e._)("code",null,"docker pull nginx\n")]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br")])],-1),wn=(0,e._)("div",{class:"custom-container tip"},[(0,e._)("p",{class:"custom-container-title"},"说明"),(0,e._)("p",null,"第一次创建 nginx 镜像的目的是不启用挂载，直接创建一个默认镜像，然后复制镜像中 nginx 的配置文件到云服务器对应的目录，方便在此基础上做修改，然后第二次创建 nginx 启用挂载模式，直接使用刚刚磁盘中的配置文件")],-1),Pn=(0,e._)("p",null,"第一次创建 nginx 镜像",-1),Tn=(0,e._)("div",{class:"language-bash ext-sh line-numbers-mode"},[(0,e._)("pre",{class:"language-bash"},[(0,e._)("code",null,[(0,e.Uk)("docker run -d --name nginx -p "),(0,e._)("span",{class:"token number"},"80"),(0,e.Uk)(":80 -d nginx\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br")])],-1),En=(0,e._)("p",null,"创建本地挂载目录",-1),An=(0,e._)("div",{class:"language-bash ext-sh line-numbers-mode"},[(0,e._)("pre",{class:"language-bash"},[(0,e._)("code",null,[(0,e._)("span",{class:"token function"},"mkdir"),(0,e.Uk)(" nginx \n"),(0,e._)("span",{class:"token builtin class-name"},"cd"),(0,e.Uk)(" nginx\n"),(0,e._)("span",{class:"token comment"},"# 批量创建 nginx 目录文件夹、用于存放配置文件、日志、ssl 证书、静态资源 "),(0,e.Uk)("\n"),(0,e._)("span",{class:"token function"},"mkdir"),(0,e.Uk)(" -p conf/conf.d logs ssl www\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br")])],-1),Gn=(0,e._)("p",null,[(0,e.Uk)("复制镜像中"),(0,e._)("code",null,"nginx.conf"),(0,e.Uk)("和"),(0,e._)("code",null,"default.conf"),(0,e.Uk)("到本地磁盘")],-1),Nn=(0,e._)("div",{class:"language-bash ext-sh line-numbers-mode"},[(0,e._)("pre",{class:"language-bash"},[(0,e._)("code",null,[(0,e._)("span",{class:"token comment"},"# 查看 nginx 运行时镜像的 CONTAINER ID"),(0,e.Uk)("\ndocker "),(0,e._)("span",{class:"token function"},"ps"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token comment"},"# 复制 nginx.conf，其中 224d770c77e8 为镜像的 CONTAINER ID ，其中/etc/nginx/nginx.conf为镜像的路径，/root/nginx/conf为云服务器配置文件的路径"),(0,e.Uk)("\ndocker "),(0,e._)("span",{class:"token function"},"cp"),(0,e.Uk)(" 224d770c77e8:/etc/nginx/nginx.conf /root/nginx/conf\n"),(0,e._)("span",{class:"token comment"},"# 复制 default.conf "),(0,e.Uk)("\ndocker "),(0,e._)("span",{class:"token function"},"cp"),(0,e.Uk)(" 224d770c77e8:/etc/nginx/conf.d/default.conf /root/nginx/conf/conf.d/default.conf\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br")])],-1),Cn=(0,e._)("p",null,"此时文件结构目录如下：",-1),In=(0,e._)("div",{class:"language-bash ext-sh line-numbers-mode"},[(0,e._)("pre",{class:"language-bash"},[(0,e._)("code",null,[(0,e.Uk)("nginx\t\t"),(0,e._)("span",{class:"token comment"},"# nginx 配置根目录 手动创建"),(0,e.Uk)("\n├── conf\t"),(0,e._)("span",{class:"token comment"},"# 配置文件目录 手动创建"),(0,e.Uk)("\n│   ├── conf.d\t"),(0,e._)("span",{class:"token comment"},"# 手动创建"),(0,e.Uk)("\n│   │   └── default.conf\t"),(0,e._)("span",{class:"token comment"},"# 服务配置文件，由 docker 镜像复制而来"),(0,e.Uk)("\n│   └── nginx.conf\t"),(0,e._)("span",{class:"token comment"},"# 主配置文件，由 docker 镜像复制而来"),(0,e.Uk)("\n├── logs\t"),(0,e._)("span",{class:"token comment"},"# 日志目录 手动创建"),(0,e.Uk)("\n├── ssl\t\t"),(0,e._)("span",{class:"token comment"},"# https 证书，后面会用 手动创建"),(0,e.Uk)("\n└── www\t\t"),(0,e._)("span",{class:"token comment"},"# 静态网页资源，自动化部署将代码推送到此目录 手动创建"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br")])],-1),Hn=(0,e._)("p",null,"检查配置文件是否已经在对应的目录中，确认无误后停用现有 nginx 镜像",-1),Ln=(0,e._)("div",{class:"language-bash ext-sh line-numbers-mode"},[(0,e._)("pre",{class:"language-bash"},[(0,e._)("code",null,[(0,e._)("span",{class:"token comment"},"# 查看当前运行的 docker 镜像"),(0,e.Uk)("\ndocker "),(0,e._)("span",{class:"token function"},"ps"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token comment"},"# 停用当前 nginx"),(0,e.Uk)("\ndocker stop 224d770c77e8\n"),(0,e._)("span",{class:"token comment"},"# 移除当前 nginx 镜像"),(0,e.Uk)("\ndocker "),(0,e._)("span",{class:"token function"},"rm"),(0,e.Uk)(" 224d770c77e8\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br")])],-1),On=(0,e._)("p",null,"再次创建 nginx 镜像，本次创建的镜像才是真正要使用的，参数多了许多磁盘挂载的参数，即镜像中对应的资源目录挂载到之前创建好的磁盘目录上，方便后续修改和使用",-1),Rn=(0,e._)("div",{class:"language-bash ext-sh line-numbers-mode"},[(0,e._)("pre",{class:"language-bash"},[(0,e._)("code",null,[(0,e._)("span",{class:"token comment"},"# 直接复制下面全部命令，粘贴到命令行运行（注意每行末尾都有个斜杠，是换行连接符）"),(0,e.Uk)("\ndocker run -d "),(0,e._)("span",{class:"token punctuation"},"\\"),(0,e.Uk)("\n--name nginx "),(0,e._)("span",{class:"token punctuation"},"\\"),(0,e.Uk)("\n-p "),(0,e._)("span",{class:"token number"},"80"),(0,e.Uk)(":80 "),(0,e._)("span",{class:"token punctuation"},"\\"),(0,e.Uk)("\n-p "),(0,e._)("span",{class:"token number"},"443"),(0,e.Uk)(":443 "),(0,e._)("span",{class:"token punctuation"},"\\"),(0,e.Uk)("\n-v /root/nginx/www:/usr/share/nginx/html "),(0,e._)("span",{class:"token punctuation"},"\\"),(0,e.Uk)("\n-v /root/nginx/conf/nginx.conf:/etc/nginx/nginx.conf "),(0,e._)("span",{class:"token punctuation"},"\\"),(0,e.Uk)("\n-v /root/nginx/conf/conf.d/default.conf:/etc/nginx/conf.d/default.conf "),(0,e._)("span",{class:"token punctuation"},"\\"),(0,e.Uk)("\n-v /root/nginx/logs:/var/log/nginx "),(0,e._)("span",{class:"token punctuation"},"\\"),(0,e.Uk)("\n-v /root/nginx/ssl:/ssl "),(0,e._)("span",{class:"token punctuation"},"\\"),(0,e.Uk)("\n-d nginx\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br")])],-1),Kn=(0,e._)("details",{class:"custom-container details"},[(0,e._)("summary",null,"-v 的参数说明"),(0,e._)("p",null,"说明"),(0,e._)("p",null,[(0,e._)("code",null,"/root/nginx/www"),(0,e.Uk)(" 用于存放nginx 挂载的静态网站")]),(0,e._)("p",null,[(0,e._)("code",null,"/root/nginx/conf/nginx.conf"),(0,e.Uk)("nginx 主配置文件")]),(0,e._)("p",null,[(0,e._)("code",null,"/root/nginx/conf/conf.d/default.conf"),(0,e.Uk)("nginx 服务端配置文件")]),(0,e._)("p",null,[(0,e._)("code",null,"/root/nginx/conf/conf.d/default.conf"),(0,e.Uk)("nginx 日志")]),(0,e._)("p",null,[(0,e._)("code",null,"/root/nginx/ssl"),(0,e.Uk)("存放域名对应的 HTTPS 证书")])],-1),Dn=(0,e._)("p",null,[(0,e.Uk)("创建成功后，可通过"),(0,e._)("code",null,"docker ps"),(0,e.Uk)("查询镜像启动的状态，启动成功的状态为"),(0,e._)("code",null,"UP")],-1),Yn=(0,e._)("h3",{id:"配置",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#配置","aria-hidden":"true"},"#"),(0,e.Uk)(" 配置")],-1),$n=(0,e._)("p",null,"进入配置文件目录，修改代理服务的配置",-1),Mn=(0,e._)("div",{class:"language-bash ext-sh line-numbers-mode"},[(0,e._)("pre",{class:"language-bash"},[(0,e._)("code",null,[(0,e._)("span",{class:"token function"},"vi"),(0,e.Uk)(" nginx/conf/conf.d default.conf\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br")])],-1),qn=(0,e._)("p",null,[(0,e.Uk)("修改"),(0,e._)("code",null,"default.conf"),(0,e.Uk)("文件，提供未开启和开启 HTTPS 访问共两种版本参考")],-1),zn=(0,e._)("ol",null,[(0,e._)("li",null,"未开启 https 版本配置")],-1),Fn=(0,e._)("details",{class:"custom-container details"},[(0,e._)("summary",null,"点击查看详细配置（修改处已加深显示）"),(0,e._)("div",{class:"language-bash ext-sh line-numbers-mode"},[(0,e._)("pre",{class:"language-bash"},[(0,e._)("code",null,[(0,e.Uk)("server "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    listen       "),(0,e._)("span",{class:"token number"},"80"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("  "),(0,e._)("span",{class:"token comment"},"#侦听80端口，即默认开启 http 访问"),(0,e.Uk)("\n    listen  "),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("::"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)(":80"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    server_name  techxiang.com,www.techxiang.com"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\t"),(0,e._)("span",{class:"token comment"},"# 需要解析的域名，也就是前面申请和解析的域名地址"),(0,e.Uk)("\n\n    "),(0,e._)("span",{class:"token comment"},"# 定义首页索引目录和名称"),(0,e.Uk)("\n    location / "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        root   /usr/share/nginx/html"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        index  index.html index.htm"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n\n    "),(0,e._)("span",{class:"token comment"},"#error_page  404              /404.html;"),(0,e.Uk)("\n\n    "),(0,e._)("span",{class:"token comment"},"# redirect server error pages to the static page /50x.html"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"# 重定向错误页面到 /50x.html"),(0,e.Uk)("\n    error_page   "),(0,e._)("span",{class:"token number"},"500"),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"502"),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"503"),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"504"),(0,e.Uk)("  /50x.html"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    location "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" /50x.html "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        root   /usr/share/nginx/html"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n\n    "),(0,e._)("span",{class:"token comment"},"# proxy the PHP scripts to Apache listening on 127.0.0.1:80"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#location ~ \\.php$ {"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#    proxy_pass   http://127.0.0.1;"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token comment"},"#}"),(0,e.Uk)("\n\n    "),(0,e._)("span",{class:"token comment"},"# pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#location ~ \\.php$ {"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#    root           html;"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#    fastcgi_pass   127.0.0.1:9000;"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#    fastcgi_index  index.php;"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#    include        fastcgi_params;"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#}"),(0,e.Uk)("\n\n    "),(0,e._)("span",{class:"token comment"},"# deny access to .htaccess files, if Apache's document root"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"# concurs with nginx's one"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#location ~ /\\.ht {"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#    deny  all;"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"highlight-lines"},[(0,e._)("br"),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br")]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"21"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"22"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"23"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"24"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"25"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"26"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"27"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"28"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"29"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"30"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"31"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"32"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"33"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"34"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"35"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"36"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"37"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"38"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"39"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"40"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"41"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"42"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"43"),(0,e._)("br")])])],-1),Bn=(0,e._)("ol",{start:"2"},[(0,e._)("li",null,"开启 https 版本配置")],-1),Vn=(0,e._)("blockquote",null,[(0,e._)("p",null,[(0,e.Uk)("开启 HTTPS 后，需要自行上传 HTTPS 证书"),(0,e._)("code",null,"server.crt"),(0,e.Uk)("和"),(0,e._)("code",null,"·server.key"),(0,e.Uk)("文件到 ssl 目录下")])],-1),Wn=(0,e._)("details",{class:"custom-container details"},[(0,e._)("summary",null,"点击查看详细配置（增加带有 ssl 的参数，已加深显示）"),(0,e._)("div",{class:"language-bash ext-sh line-numbers-mode"},[(0,e._)("pre",{class:"language-bash"},[(0,e._)("code",null,[(0,e.Uk)("server "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    listen       "),(0,e._)("span",{class:"token number"},"80"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("  "),(0,e._)("span",{class:"token comment"},"#侦听80端口，即默认开启 http 访问，如果强制所有的访问都必须是HTTPSS 话，80端口的都需要注销掉"),(0,e.Uk)("\n    listen  "),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("::"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)(":80"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    listen    "),(0,e._)("span",{class:"token number"},"443"),(0,e.Uk)(" ssl"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    server_name  techxiang.com,www.techxiang.com"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\t"),(0,e._)("span",{class:"token comment"},"# 需要解析的域名，也就是前面申请和解析的域名地址"),(0,e.Uk)("\n\n    "),(0,e._)("span",{class:"token comment"},"# 增加ssl"),(0,e.Uk)("\n    ssl on"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("        "),(0,e._)("span",{class:"token comment"},"# 如果强制HTTPs访问，这行要打开"),(0,e.Uk)("\n    ssl_certificate /ssl/server.crt"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\t"),(0,e._)("span",{class:"token comment"},"# https证书存放位置"),(0,e.Uk)("\n    ssl_certificate_key /ssl/server.key"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\t"),(0,e._)("span",{class:"token comment"},"# https证书存放位置"),(0,e.Uk)("\n\n    ssl_session_cache    shared:SSL:1m"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    ssl_session_timeout  5m"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n\n     "),(0,e._)("span",{class:"token comment"},"# 指定密码为openssl支持的格式"),(0,e.Uk)("\n     ssl_protocols  SSLv2 SSLv3 TLSv1.2"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n\n     ssl_ciphers  HIGH:"),(0,e._)("span",{class:"token operator"},"!"),(0,e.Uk)("aNULL:"),(0,e._)("span",{class:"token operator"},"!"),(0,e.Uk)("MD5"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("  "),(0,e._)("span",{class:"token comment"},"# 密码加密方式"),(0,e.Uk)("\n     ssl_prefer_server_ciphers  on"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("   "),(0,e._)("span",{class:"token comment"},"# 依赖SSLv3和TLSv1协议的服务器密码将优先于客户端密码"),(0,e.Uk)("\n\n    "),(0,e._)("span",{class:"token comment"},"#access_log  /var/log/nginx/host.access.log  main;"),(0,e.Uk)("\n\n    "),(0,e._)("span",{class:"token comment"},"# 定义首页索引目录和名称"),(0,e.Uk)("\n    location / "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        root   /usr/share/nginx/html"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        index  index.html index.htm"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n\n    "),(0,e._)("span",{class:"token comment"},"#error_page  404              /404.html;"),(0,e.Uk)("\n\n    "),(0,e._)("span",{class:"token comment"},"# redirect server error pages to the static page /50x.html"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"# 重定向错误页面到 /50x.html"),(0,e.Uk)("\n    error_page   "),(0,e._)("span",{class:"token number"},"500"),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"502"),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"503"),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"504"),(0,e.Uk)("  /50x.html"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    location "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" /50x.html "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        root   /usr/share/nginx/html"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n\n    "),(0,e._)("span",{class:"token comment"},"# proxy the PHP scripts to Apache listening on 127.0.0.1:80"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#location ~ \\.php$ {"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#    proxy_pass   http://127.0.0.1;"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token comment"},"#}"),(0,e.Uk)("\n\n    "),(0,e._)("span",{class:"token comment"},"# pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#location ~ \\.php$ {"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#    root           html;"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#    fastcgi_pass   127.0.0.1:9000;"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#    fastcgi_index  index.php;"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#    include        fastcgi_params;"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#}"),(0,e.Uk)("\n\n    "),(0,e._)("span",{class:"token comment"},"# deny access to .htaccess files, if Apache's document root"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"# concurs with nginx's one"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#location ~ /\\.ht {"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#    deny  all;"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"#}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"highlight-lines"},[(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("br"),(0,e._)("br"),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br")]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"21"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"22"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"23"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"24"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"25"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"26"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"27"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"28"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"29"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"30"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"31"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"32"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"33"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"34"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"35"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"36"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"37"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"38"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"39"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"40"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"41"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"42"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"43"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"44"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"45"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"46"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"47"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"48"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"49"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"50"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"51"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"52"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"53"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"54"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"55"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"56"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"57"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"58"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"59"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"60"),(0,e._)("br")])])],-1),jn=(0,e._)("p",null,"都配置好后，重启 nginx",-1),Jn=(0,e._)("div",{class:"language-bash ext-sh line-numbers-mode"},[(0,e._)("pre",{class:"language-bash"},[(0,e._)("code",null,[(0,e._)("span",{class:"token comment"},"# 查询 nginx 镜像 id"),(0,e.Uk)("\ndocker "),(0,e._)("span",{class:"token function"},"ps"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token comment"},"# 重启 nginx ,此处 e60222e0a641 为第二次 nginx 镜像 id"),(0,e.Uk)("\ndocker restart e60222e0a641\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br")])],-1),Qn=(0,e._)("div",{class:"custom-container tip"},[(0,e._)("p",{class:"custom-container-title"},"恭喜 ~ 🎉 🎉 🎉"),(0,e._)("p",null,"至此，服务器开启域名访问的相关配置已经完成，通过输入注册的域名，访问一下自己的网站吧")],-1),Xn={render:function(n,s){const a=(0,e.up)("Badge"),l=(0,e.up)("OutboundLink");return(0,e.wg)(),(0,e.iD)(e.HY,null,[o,u,p,b,k,m,d,h,U,g,x,f,v,y,S,w,P,T,E,A,G,N,C,I,H,L,O,R,K,D,Y,$,M,q,z,F,B,V,W,j,J,Q,X,Z,nn,(0,e._)("h3",sn,[an,en,(0,e.Wm)(a,{type:"danger",text:"待完善",vertical:"top"})]),(0,e._)("p",null,[ln,(0,e._)("a",tn,[cn,(0,e.Wm)(l)]),_n]),rn,on,un,pn,bn,kn,(0,e._)("h2",mn,[dn,hn,(0,e.Wm)(a,{type:"danger",text:"待完善",vertical:"top"})]),Un,gn,xn,fn,vn,yn,Sn,wn,Pn,Tn,En,An,Gn,Nn,Cn,In,Hn,Ln,On,Rn,Kn,Dn,Yn,$n,Mn,qn,zn,Fn,Bn,Vn,Wn,jn,Jn,Qn],64)}}},7688:(n,s,a)=>{n.exports=a.p+"assets/img/20210810153125.473dd4f2.png"},1940:(n,s,a)=>{n.exports=a.p+"assets/img/20210810153315.b5f04f57.png"},7933:(n,s,a)=>{n.exports=a.p+"assets/img/20210810153353.a56d4d54.png"},6818:(n,s,a)=>{n.exports=a.p+"assets/img/20210810153805.533deb5b.png"},8914:(n,s,a)=>{n.exports=a.p+"assets/img/20210810153847.f09dfcee.png"},1643:(n,s,a)=>{n.exports=a.p+"assets/img/20210810153949.482afe37.png"}}]);